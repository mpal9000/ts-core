import test from 'ava'
import { wrapIs, isType, f, nf, npf, nnf, pf } from '../test.js'
import { EPSILON, SMALLEST, MINIMUM, MAXIMUM } from './constants.js'
import { toString } from './toString.js'

test('toString()', (t) => {
  const is: ReturnType<typeof wrapIs> = wrapIs(t)

  isType<string>()(toString(f()))
  isType<string>()(toString(nf()))
  isType<string>()(toString(npf()))
  isType<string>()(toString(nnf()))
  isType<string>()(toString(pf()))

  isType<string>()(toString(10, f()))
  isType<string>()(toString(10, nf()))
  isType<string>()(toString(10, npf()))
  isType<string>()(toString(10, nnf()))
  isType<string>()(toString(10, pf()))

  is('-1.7976931348623157e+308', toString(f(MINIMUM)))
  is('-1262.148', toString(f(-1262.148)))
  is('-65.118', toString(f(-65.118)))
  is('-46.15', toString(f(-46.15)))
  is('-42.1', toString(f(-42.1)))
  is('-39.1425', toString(f(-39.1425)))
  is('-18.115', toString(f(-18.115)))
  is('-17.11', toString(f(-17.11)))
  is('-17.1', toString(f(-17.1)))
  is('-9.113', toString(f(-9.113)))
  is('-5.112', toString(f(-5.112)))
  is('-4.16', toString(f(-4.16)))
  is('-4.15', toString(f(-4.15)))
  is('-3.19', toString(f(-3.19)))
  is('-3.15', toString(f(-3.15)))
  is('-3.11', toString(f(-3.11)))
  is('-3.1', toString(f(-3.1)))
  is('-2.19', toString(f(-2.19)))
  is('-2.15', toString(f(-2.15)))
  is('-2.126', toString(f(-2.126)))
  is('-2.11755465135353', toString(f(-2.11755465135353)))
  is('-2.1175495134384', toString(f(-2.1175495134384)))
  is('-2.11753543549', toString(f(-2.11753543549)))
  is('-2.11', toString(f(-2.11)))
  is('-2.1', toString(f(-2.1)))
  is('-1.23', toString(f(-1.23)))
  is('-1.19', toString(f(-1.19)))
  is('-1.15', toString(f(-1.15)))
  is('-1.4999999999999998', toString(f(-1.4999999999999998)))
  is('-1.1499999999999997', toString(f(-1.1499999999999998)))
  is('-1.149999999999998', toString(f(-1.149999999999998)))
  is('-1.145', toString(f(-1.145)))
  is('-1.134', toString(f(-1.134)))
  is('-1.1123456789', toString(f(-1.1123456789)))
  is('-1.11', toString(f(-1.11)))
  is('-1.1015', toString(f(-1.1015)))
  is('-1.1005', toString(f(-1.1005)))
  is('-1.10049999', toString(f(-1.10049999)))
  is('-1.1', toString(f(-1.1)))
  is('-1.015', toString(f(-1.015)))
  is('-1.005', toString(f(-1.005)))
  is('-1', toString(f(-1.0)))
  is('-1', toString(f(-1)))
  is('-0.5000000000000001', toString(f(-0.5000000000000001)))
  is('-0.49999999999999994', toString(f(-0.49999999999999994)))
  is('-0.19', toString(f(-0.19)))
  is('-0.16', toString(f(-0.16)))
  is('-0.15000000000000002', toString(f(-0.15000000000000001)))
  is('-0.1500000000000001', toString(f(-0.1500000000000001)))
  is('-0.15', toString(f(-0.15)))
  is('-0.14999999999999994', toString(f(-0.14999999999999994)))
  is('-0.14', toString(f(-0.14)))
  is('-0.12', toString(f(-0.12)))
  is('-0.11', toString(f(-0.11)))
  is('-0.10149999999999999', toString(f(-0.1014999999999999999)))
  is('-0.10149999999999999', toString(f(-0.101499999999999999)))
  is('-0.10000001', toString(f(-0.10000001)))
  is('-0.1', toString(f(-0.1)))
  is('-1e-8', toString(f(-1e-8)))
  is('-2.220446049250313e-16', toString(f(-EPSILON)))
  is('-5e-324', toString(f(-SMALLEST)))
  is('0', toString(f(-0.0)))
  is('0', toString(f(-0)))
  is('0', toString(f(0)))
  is('0', toString(f(0.0)))
  is('5e-324', toString(f(SMALLEST)))
  is('2.220446049250313e-16', toString(f(EPSILON)))
  is('1e-8', toString(f(1e-8)))
  is('0.1', toString(f(0.1)))
  is('0.10000001', toString(f(0.10000001)))
  is('0.10149999999999999', toString(f(0.101499999999999999)))
  is('0.10149999999999999', toString(f(0.1014999999999999999)))
  is('0.11', toString(f(0.11)))
  is('0.12', toString(f(0.12)))
  is('0.14', toString(f(0.14)))
  is('0.14999999999999994', toString(f(0.14999999999999994)))
  is('0.15', toString(f(0.15)))
  is('0.1500000000000001', toString(f(0.1500000000000001)))
  is('0.15000000000000002', toString(f(0.15000000000000001)))
  is('0.16', toString(f(0.16)))
  is('0.19', toString(f(0.19)))
  is('0.49999999999999994', toString(f(0.49999999999999994)))
  is('0.5000000000000001', toString(f(0.5000000000000001)))
  is('1', toString(f(1)))
  is('1', toString(f(1.0)))
  is('1.005', toString(f(1.005)))
  is('1.015', toString(f(1.015)))
  is('1.1', toString(f(1.1)))
  is('1.10049999', toString(f(1.10049999)))
  is('1.1005', toString(f(1.1005)))
  is('1.1015', toString(f(1.1015)))
  is('1.11', toString(f(1.11)))
  is('1.1123456789', toString(f(1.1123456789)))
  is('1.134', toString(f(1.134)))
  is('1.145', toString(f(1.145)))
  is('1.149999999999998', toString(f(1.149999999999998)))
  is('1.1499999999999997', toString(f(1.1499999999999998)))
  is('1.4999999999999998', toString(f(1.4999999999999998)))
  is('1.15', toString(f(1.15)))
  is('1.19', toString(f(1.19)))
  is('1.23', toString(f(1.23)))
  is('2.1', toString(f(2.1)))
  is('2.11', toString(f(2.11)))
  is('2.11753543549', toString(f(2.11753543549)))
  is('2.1175495134384', toString(f(2.1175495134384)))
  is('2.11755465135353', toString(f(2.11755465135353)))
  is('2.126', toString(f(2.126)))
  is('2.15', toString(f(2.15)))
  is('2.19', toString(f(2.19)))
  is('3.1', toString(f(3.1)))
  is('3.11', toString(f(3.11)))
  is('3.15', toString(f(3.15)))
  is('3.19', toString(f(3.19)))
  is('4.15', toString(f(4.15)))
  is('4.16', toString(f(4.16)))
  is('5.112', toString(f(5.112)))
  is('9.113', toString(f(9.113)))
  is('17.1', toString(f(17.1)))
  is('17.11', toString(f(17.11)))
  is('18.115', toString(f(18.115)))
  is('39.1425', toString(f(39.1425)))
  is('42.1', toString(f(42.1)))
  is('46.15', toString(f(46.15)))
  is('65.118', toString(f(65.118)))
  is('1262.148', toString(f(1262.148)))
  is('1.7976931348623157e+308', toString(f(MAXIMUM)))

  is('-1.7976931348623157e+308', toString(f(MINIMUM - 10 ** 291)))
  is('-1.7976931348623155e+308', toString(f(MINIMUM + 10 ** 292)))
  is('-7.976931348623157e+307', toString(f(MINIMUM + 10 ** 308)))
  is('7.976931348623157e+307', toString(f(MAXIMUM - 10 ** 308)))
  is('1.7976931348623155e+308', toString(f(MAXIMUM - 10 ** 292)))
  is('1.7976931348623157e+308', toString(f(MAXIMUM + 10 ** 291)))

  is(
    '-1.0111111111111111111111111111111111111111111111111111',
    toString(2, f(-1.4999999999999998)),
  )

  // @ts-expect-error
  t.throws(() => isType<string>()(toString(1, f())))
  // @ts-expect-error
  t.throws(() => isType<string>()(toString(37, f())))
})
